# CLAUDE.md

このファイルは、Claude Code (claude.ai/code) がこのリポジトリで作業する際のガイダンスを提供します。

## プロジェクト概要

モバイル最適化されたマインスイーパーゲーム。vanilla HTML/CSS/JavaScriptで構築。共通コアを共有する複数バージョン（mobile、PC、DX）をサポートするモノレポ構造を採用。

## コマンド

ビルドプロセスのない静的Webアプリケーション：
- **ローカル実行**: `products/mobile/index.html` または `products/pc/index.html` をブラウザで直接開く
- **デプロイ**: GitHubにプッシュしてGitHub Pagesを有効化（mainブランチから配信）
- **npm/ビルド/テストコマンドなし**: 純粋なvanilla JavaScriptプロジェクト

## アーキテクチャ

### コアモジュールパターン
- `/core/minesweeper-core.js`: ゲームロジックを持つ基底クラス（ボード管理、地雷配置、勝利/敗北条件）
- 製品バージョンは `MinesweeperCore` クラスを拡張してプラットフォーム固有の機能を追加
- ES6クラスを使用した継承ベースのアーキテクチャ

### 製品構造と分離開発
```
/products/
├── mobile/   # タッチ最適化版（長押し対応）
├── pc/       # デスクトップ版（マウス操作）
└── dx/       # 拡張版（計画中）
```

**重要: PC版とモバイル版は完全に分離して開発**
- PC版（`/products/pc/`）: デスクトップブラウザ専用の機能実装
- モバイル版（`/products/mobile/`）: スマートフォン・タブレット専用の機能実装
- 各バージョンは独自のHTML/CSS/JSを持つ自己完結型
- プラットフォーム固有の機能は対応するバージョンにのみ実装
- デバイス判定コードは互換性チェック用であり、クロスプラットフォーム対応を意図していない

各製品は以下のようにコアモジュールをインポート：
```javascript
class MobileMinesweeper extends MinesweeperCore { ... }
class PCMinesweeper extends MinesweeperCore { ... }
```

### バージョン別の主要機能

**モバイル版 (`/products/mobile/`):**
- タッチ操作: タップで開く、長押しで旗を立てる
- 大きなボードでドラッグスクロール
- 旗モードトグルで簡単に旗を立てる
- 隠し/エクストリームモードを含む難易度レベル
- ビューポートスケーリングによるレスポンシブデザイン

**PC版 (`/products/pc/`):**
- マウス操作: 左クリックで開く、右クリックで旗
- キーボードショートカット対応
- 標準難易度レベル

### ゲーム状態管理
- ボード状態: 地雷、開いたセル、旗、?マークの2次元配列
- 可視性変更時の一時停止/再開機能付きタイマーシステム
- 最初のクリック保護（最初のクリック後に地雷配置）
- 勝利条件: すべての非地雷セルが開かれる
- 敗北条件: 地雷セルが開かれる

## 開発ガイドライン

### バグ修正・機能改善時の重要な注意事項
**問題がPC版かモバイル版のどちらで発生しているか不明な場合:**
1. まずユーザーに「PC版とモバイル版のどちらを修正すればよいですか？」と確認する
2. 両方の修正が必要な場合は、両方のバージョンを確認して修正する
3. 勝手に片方だけ（特にモバイル版だけ）を修正しない

### 新機能の追加
1. 共通機能は `/core/minesweeper-core.js` へ
2. プラットフォーム固有の機能は各 `/products/*/game.js` へ
3. クラス継承とフックメソッドのオーバーライドを使用（`onGameOver`、`onGameWon` など）

### スタイリング
- 各製品は独自の `style.css` を持つ
- モバイル版はテーマ用のCSS変数を使用
- ビューポート単位とメディアクエリによるレスポンシブデザイン

### ランディングページ
ルートの `index.html` はデバイス検出に基づいてモバイル版またはPC版に自動リダイレクト：
```javascript
'ontouchstart' in window || navigator.maxTouchPoints > 0
```