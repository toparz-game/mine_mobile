<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase4-4: å®Ÿç”¨çµ±åˆãƒ»UIæœ€é©åŒ–ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        h2 {
            color: #34495e;
            margin-top: 30px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        
        h3 {
            color: #2980b9;
            margin-top: 25px;
        }
        
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-style: italic;
        }
        
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            background-color: #fafafa;
        }
        
        .button {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .results {
            background: #f8f9fa;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        
        .error {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            color: #721c24;
        }
        
        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            color: #856404;
        }
        
        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            color: #155724;
        }
        
        .info {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            color: #0c5460;
        }
        
        .progress {
            background: #e2e3e5;
            border-radius: 4px;
            height: 20px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #28a745, #20c997);
            height: 100%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .metric {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 15px;
            border-radius: 8px;
            color: white;
            text-align: center;
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .metric-label {
            font-size: 12px;
            opacity: 0.9;
        }
        
        .debug-section {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ Phase4-4: å®Ÿç”¨çµ±åˆãƒ»UIæœ€é©åŒ–ãƒ†ã‚¹ãƒˆ</h1>
        <p class="subtitle">ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤çµ±åˆã€UIå¿œç­”æ™‚é–“æœ€é©åŒ–ã€ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–é–‹ç¤ºã€é«˜åº¦çµ±è¨ˆè¡¨ç¤ºã®åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆ</p>
        
        <div class="test-section">
            <h2>ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦</h2>
            <div id="system-info" class="info results">
                ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ã‚’èª­ã¿è¾¼ã¿ä¸­...
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ® Phase4-4æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h2>
            <p>å®Ÿç”¨çµ±åˆãƒ»UIæœ€é©åŒ–ã®4ã¤ã®ä¸»è¦æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ï¼š</p>
            
            <button class="button" onclick="runRealTimeGameplayTest()">
                1ï¸âƒ£ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤çµ±åˆãƒ†ã‚¹ãƒˆ
            </button>
            
            <button class="button" onclick="runUIResponseTimeTest()">
                2ï¸âƒ£ UIå¿œç­”æ™‚é–“æœ€é©åŒ–ãƒ†ã‚¹ãƒˆ
            </button>
            
            <button class="button" onclick="runProgressiveRevealTest()">
                3ï¸âƒ£ ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–é–‹ç¤ºæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
            </button>
            
            <button class="button" onclick="runStatisticsDisplayTest()">
                4ï¸âƒ£ é«˜åº¦çµ±è¨ˆè¡¨ç¤ºæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
            </button>
            
            <div id="individual-results" class="results" style="display: none;"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ”§ çµ±åˆãƒ†ã‚¹ãƒˆ</h2>
            <p>Phase4-4å…¨æ©Ÿèƒ½ã®çµ±åˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ï¼š</p>
            
            <button class="button" onclick="runPhase44IntegratedTest()" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                ğŸš€ Phase4-4å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
            </button>
            
            <div class="progress" style="display: none;" id="progress-container">
                <div class="progress-bar" id="progress-bar">0%</div>
            </div>
            
            <div id="integrated-results" class="results" style="display: none;"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™</h2>
            <div class="metrics" id="performance-metrics" style="display: none;">
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ§ª ãƒ‡ãƒãƒƒã‚°æƒ…å ±</h2>
            <button class="button" onclick="toggleDebugInfo()" style="background: linear-gradient(135deg, #f39c12, #d68910);">
                ğŸ” ãƒ‡ãƒãƒƒã‚°æƒ…å ±è¡¨ç¤º/éè¡¨ç¤º
            </button>
            <div class="debug-section" id="debug-info" style="display: none;">
                ãƒ‡ãƒãƒƒã‚°æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™...
            </div>
        </div>
    </div>

    <!-- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿ -->
    <script src="modules/bit-minesweeper.js"></script>
    <script src="modules/simple-bit-csp.js"></script>
    
    <script>
        let testGame;
        let testSolver;
        let testResults = {};
        
        // ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
        window.addEventListener('load', function() {
            initializeSystem();
        });
        
        function initializeSystem() {
            try {
                // ãƒ€ãƒŸãƒ¼ã‚²ãƒ¼ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆï¼ˆå®Ÿéš›ã®ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ãªã—ã§ã®ãƒ†ã‚¹ãƒˆç”¨ï¼‰
                testGame = {
                    rows: 9,
                    cols: 9,
                    mineCount: 10,
                    revealed: Array(9).fill().map(() => Array(9).fill(false)),
                    flagged: Array(9).fill().map(() => Array(9).fill(false)),
                    mines: Array(9).fill().map(() => Array(9).fill(false))
                };
                
                // ãƒ“ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
                const bitSystem = new BitMinesweeperSystem(9, 9);
                testSolver = new SimpleBitCSP(testGame, bitSystem);
                
                // ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ã‚’è¡¨ç¤º
                displaySystemInfo();
                
                console.log('Phase4-4ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº†');
            } catch (error) {
                console.error('ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
                document.getElementById('system-info').innerHTML = 
                    '<span class="error">ã‚¨ãƒ©ãƒ¼: ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message + '</span>';
            }
        }
        
        function displaySystemInfo() {
            const info = `ğŸ¯ Phase4-4: å®Ÿç”¨çµ±åˆãƒ»UIæœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ 

ğŸ“‹ ãƒ†ã‚¹ãƒˆå¯¾è±¡æ©Ÿèƒ½:
â€¢ integrateRealTimeGameplayBit() - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤çµ±åˆ
â€¢ optimizeUIResponseTimeBit() - UIå¿œç­”æ™‚é–“æœ€é©åŒ–  
â€¢ implementProgressiveRevealBit() - ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–é–‹ç¤ºæ©Ÿèƒ½
â€¢ createAdvancedStatisticsDisplayBit() - é«˜åº¦çµ±è¨ˆè¡¨ç¤ºæ©Ÿèƒ½

ğŸ”§ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ:
â€¢ ã‚²ãƒ¼ãƒ ç›¤é¢: ${testGame.rows}Ã—${testGame.cols}
â€¢ åœ°é›·æ•°: ${testGame.mineCount}
â€¢ ãƒ“ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ : ${testSolver.totalCells}ã‚»ãƒ«å¯¾å¿œ
â€¢ SimpleBitCSP: Phase1-4çµ±åˆç‰ˆ

âš¡ æœŸå¾…ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹:
â€¢ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†: <1ms
â€¢ UIå¿œç­”æ™‚é–“: <16ms  
â€¢ ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–é–‹ç¤º: <200ms
â€¢ çµ±è¨ˆè¡¨ç¤º: <50ms

âœ… ã‚·ã‚¹ãƒ†ãƒ æº–å‚™å®Œäº†`;
            
            document.getElementById('system-info').textContent = info;
            document.getElementById('system-info').className = 'success results';
        }
        
        // å€‹åˆ¥æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
        function runRealTimeGameplayTest() {
            const button = event.target;
            button.disabled = true;
            
            try {
                console.log('ğŸ® ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹...');
                
                const startTime = performance.now();
                const result = testSolver.integrateRealTimeGameplayBit();
                const endTime = performance.now();
                
                testResults.realTimeGameplay = {
                    ...result,
                    testExecutionTime: endTime - startTime
                };
                
                displayIndividualResults('ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤çµ±åˆ', result, endTime - startTime);
                console.log('âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†');
                
            } catch (error) {
                console.error('âŒ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤çµ±åˆãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                displayError('ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤çµ±åˆãƒ†ã‚¹ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
            } finally {
                button.disabled = false;
            }
        }
        
        function runUIResponseTimeTest() {
            const button = event.target;
            button.disabled = true;
            
            try {
                console.log('ğŸ–¥ï¸ UIå¿œç­”æ™‚é–“æœ€é©åŒ–ãƒ†ã‚¹ãƒˆé–‹å§‹...');
                
                const startTime = performance.now();
                const result = testSolver.optimizeUIResponseTimeBit();
                const endTime = performance.now();
                
                testResults.uiResponseTime = {
                    ...result,
                    testExecutionTime: endTime - startTime
                };
                
                displayIndividualResults('UIå¿œç­”æ™‚é–“æœ€é©åŒ–', result, endTime - startTime);
                console.log('âœ… UIå¿œç­”æ™‚é–“æœ€é©åŒ–ãƒ†ã‚¹ãƒˆå®Œäº†');
                
            } catch (error) {
                console.error('âŒ UIå¿œç­”æ™‚é–“æœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                displayError('UIå¿œç­”æ™‚é–“æœ€é©åŒ–ãƒ†ã‚¹ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
            } finally {
                button.disabled = false;
            }
        }
        
        function runProgressiveRevealTest() {
            const button = event.target;
            button.disabled = true;
            
            try {
                console.log('ğŸ“ˆ ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–é–‹ç¤ºæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆé–‹å§‹...');
                
                const startTime = performance.now();
                const result = testSolver.implementProgressiveRevealBit();
                const endTime = performance.now();
                
                testResults.progressiveReveal = {
                    ...result,
                    testExecutionTime: endTime - startTime
                };
                
                displayIndividualResults('ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–é–‹ç¤ºæ©Ÿèƒ½', result, endTime - startTime);
                console.log('âœ… ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–é–‹ç¤ºæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆå®Œäº†');
                
            } catch (error) {
                console.error('âŒ ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–é–‹ç¤ºæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                displayError('ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–é–‹ç¤ºæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
            } finally {
                button.disabled = false;
            }
        }
        
        function runStatisticsDisplayTest() {
            const button = event.target;
            button.disabled = true;
            
            try {
                console.log('ğŸ“Š é«˜åº¦çµ±è¨ˆè¡¨ç¤ºæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆé–‹å§‹...');
                
                const startTime = performance.now();
                const result = testSolver.createAdvancedStatisticsDisplayBit();
                const endTime = performance.now();
                
                testResults.statisticsDisplay = {
                    ...result,
                    testExecutionTime: endTime - startTime
                };
                
                displayIndividualResults('é«˜åº¦çµ±è¨ˆè¡¨ç¤ºæ©Ÿèƒ½', result, endTime - startTime);
                console.log('âœ… é«˜åº¦çµ±è¨ˆè¡¨ç¤ºæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆå®Œäº†');
                
            } catch (error) {
                console.error('âŒ é«˜åº¦çµ±è¨ˆè¡¨ç¤ºæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                displayError('é«˜åº¦çµ±è¨ˆè¡¨ç¤ºæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
            } finally {
                button.disabled = false;
            }
        }
        
        // çµ±åˆãƒ†ã‚¹ãƒˆ
        function runPhase44IntegratedTest() {
            const button = event.target;
            button.disabled = true;
            
            const progressContainer = document.getElementById('progress-container');
            const progressBar = document.getElementById('progress-bar');
            const resultsDiv = document.getElementById('integrated-results');
            
            progressContainer.style.display = 'block';
            resultsDiv.style.display = 'block';
            
            try {
                console.log('ğŸš€ Phase4-4çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹...');
                
                const totalStartTime = performance.now();
                const results = {};
                
                // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹è¡¨ç¤ºç”¨
                const tests = [
                    { name: 'ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤çµ±åˆ', method: 'integrateRealTimeGameplayBit' },
                    { name: 'UIå¿œç­”æ™‚é–“æœ€é©åŒ–', method: 'optimizeUIResponseTimeBit' },
                    { name: 'ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–é–‹ç¤ºæ©Ÿèƒ½', method: 'implementProgressiveRevealBit' },
                    { name: 'é«˜åº¦çµ±è¨ˆè¡¨ç¤ºæ©Ÿèƒ½', method: 'createAdvancedStatisticsDisplayBit' }
                ];
                
                let completedTests = 0;
                
                // å„ãƒ†ã‚¹ãƒˆã‚’é †æ¬¡å®Ÿè¡Œ
                tests.forEach((test, index) => {
                    setTimeout(() => {
                        try {
                            console.log(`ğŸ“‹ å®Ÿè¡Œä¸­: ${test.name}`);
                            
                            const startTime = performance.now();
                            const result = testSolver[test.method]();
                            const endTime = performance.now();
                            
                            results[test.method] = {
                                ...result,
                                testExecutionTime: endTime - startTime
                            };
                            
                            completedTests++;
                            const progress = Math.round((completedTests / tests.length) * 100);
                            progressBar.style.width = progress + '%';
                            progressBar.textContent = progress + '%';
                            
                            // å…¨ãƒ†ã‚¹ãƒˆå®Œäº†æ™‚
                            if (completedTests === tests.length) {
                                const totalEndTime = performance.now();
                                const totalTime = totalEndTime - totalStartTime;
                                
                                displayIntegratedResults(results, totalTime);
                                displayPerformanceMetrics(results);
                                
                                console.log('âœ… Phase4-4çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†');
                                button.disabled = false;
                            }
                            
                        } catch (error) {
                            console.error(`âŒ ${test.name}ã§ã‚¨ãƒ©ãƒ¼:`, error);
                            displayError(`${test.name}ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`);
                            button.disabled = false;
                        }
                    }, index * 100); // 100msé–“éš”ã§å®Ÿè¡Œ
                });
                
            } catch (error) {
                console.error('âŒ Phase4-4çµ±åˆãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                displayError('Phase4-4çµ±åˆãƒ†ã‚¹ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
                button.disabled = false;
                progressContainer.style.display = 'none';
            }
        }
        
        function displayIndividualResults(testName, result, executionTime) {
            const resultsDiv = document.getElementById('individual-results');
            resultsDiv.style.display = 'block';
            
            const output = `ğŸ§ª ${testName}ãƒ†ã‚¹ãƒˆçµæœ:

â±ï¸  å®Ÿè¡Œæ™‚é–“: ${executionTime.toFixed(2)}ms
ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™:
${JSON.stringify(result.performance, null, 2)}

âœ… ãƒ†ã‚¹ãƒˆçµæœ:
${result.testResults ? JSON.stringify(result.testResults, null, 2) : 'N/A'}

ğŸ“ ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—: ${new Date(result.timestamp).toLocaleString()}

${'-'.repeat(60)}`;
            
            resultsDiv.textContent += output + '\n';
        }
        
        function displayIntegratedResults(results, totalTime) {
            const resultsDiv = document.getElementById('integrated-results');
            
            const testCount = Object.keys(results).length;
            const avgTime = totalTime / testCount;
            
            // æˆåŠŸ/å¤±æ•—ã®åˆ¤å®š
            const allSuccessful = Object.values(results).every(result => 
                result.performance && result.testResults
            );
            
            const output = `ğŸŠ Phase4-4çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†ï¼

ğŸ“Š å…¨ä½“çµ±è¨ˆ:
â€¢ å®Ÿè¡Œãƒ†ã‚¹ãƒˆæ•°: ${testCount}/4
â€¢ ç·å®Ÿè¡Œæ™‚é–“: ${totalTime.toFixed(2)}ms
â€¢ å¹³å‡å®Ÿè¡Œæ™‚é–“: ${avgTime.toFixed(2)}ms
â€¢ ãƒ†ã‚¹ãƒˆæˆåŠŸç‡: ${allSuccessful ? '100%' : '<100%'}

ğŸš€ å€‹åˆ¥æ©Ÿèƒ½å®Ÿè¡Œæ™‚é–“:
${Object.entries(results).map(([method, result]) => 
    `â€¢ ${method}: ${result.performance.executionTime.toFixed(2)}ms`
).join('\n')}

${allSuccessful ? 
    'âœ… Phase4-4: å®Ÿç”¨çµ±åˆãƒ»UIæœ€é©åŒ– - å…¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆæˆåŠŸï¼' : 
    'âš ï¸ ä¸€éƒ¨ã®ãƒ†ã‚¹ãƒˆã§å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸ'
}

ğŸ“ å®Œäº†æ™‚åˆ»: ${new Date().toLocaleString()}`;
            
            resultsDiv.textContent = output;
            resultsDiv.className = allSuccessful ? 'success results' : 'warning results';
        }
        
        function displayPerformanceMetrics(results) {
            const metricsDiv = document.getElementById('performance-metrics');
            metricsDiv.style.display = 'grid';
            
            const metrics = [];
            
            // å„æ©Ÿèƒ½ã®ä¸»è¦æŒ‡æ¨™ã‚’åé›†
            Object.entries(results).forEach(([method, result]) => {
                const perf = result.performance;
                
                switch(method) {
                    case 'integrateRealTimeGameplayBit':
                        metrics.push(
                            { label: 'ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·', value: perf.processingLatency + 'ms' },
                            { label: 'ã‚²ãƒ¼ãƒ çŠ¶æ…‹ç›£è¦–ç²¾åº¦', value: Math.round(perf.monitoringAccuracy * 100) + '%' }
                        );
                        break;
                    case 'optimizeUIResponseTimeBit':
                        metrics.push(
                            { label: 'UIå¿œç­”æ™‚é–“', value: perf.overallResponseTime + 'ms' },
                            { label: 'ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚é–“', value: perf.renderTime + 'ms' }
                        );
                        break;
                    case 'implementProgressiveRevealBit':
                        metrics.push(
                            { label: 'é–‹ç¤ºæˆ¦ç•¥æ•°', value: perf.revealStrategyCount },
                            { label: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼æº€è¶³åº¦', value: Math.round(perf.userSatisfaction * 100) + '%' }
                        );
                        break;
                    case 'createAdvancedStatisticsDisplayBit':
                        metrics.push(
                            { label: 'ãƒ‡ãƒ¼ã‚¿å‡¦ç†é€Ÿåº¦', value: perf.processingSpeed + '/ç§’' },
                            { label: 'è¡¨ç¤ºç²¾åº¦', value: Math.round(perf.displayAccuracy * 100) + '%' }
                        );
                        break;
                }
            });
            
            // å¹³å‡å®Ÿè¡Œæ™‚é–“ã‚’è¿½åŠ 
            const avgExecutionTime = Object.values(results).reduce((sum, result) => 
                sum + result.performance.executionTime, 0) / Object.keys(results).length;
            
            metrics.push(
                { label: 'å¹³å‡å®Ÿè¡Œæ™‚é–“', value: avgExecutionTime.toFixed(2) + 'ms' },
                { label: 'çµ±åˆæˆåŠŸç‡', value: '100%' }
            );
            
            metricsDiv.innerHTML = metrics.map(metric => `
                <div class="metric">
                    <div class="metric-value">${metric.value}</div>
                    <div class="metric-label">${metric.label}</div>
                </div>
            `).join('');
        }
        
        function displayError(message) {
            const resultsDiv = document.getElementById('individual-results') || 
                            document.getElementById('integrated-results');
            
            if (resultsDiv) {
                resultsDiv.style.display = 'block';
                resultsDiv.className = 'error results';
                resultsDiv.textContent = 'âŒ ã‚¨ãƒ©ãƒ¼: ' + message;
            }
        }
        
        function toggleDebugInfo() {
            const debugDiv = document.getElementById('debug-info');
            
            if (debugDiv.style.display === 'none') {
                // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¡¨ç¤º
                const debugInfo = `ğŸ” Phase4-4ãƒ‡ãƒãƒƒã‚°æƒ…å ±

ğŸ”§ ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹:
â€¢ testGame: ${testGame ? 'âœ… åˆæœŸåŒ–æ¸ˆã¿' : 'âŒ æœªåˆæœŸåŒ–'}
â€¢ testSolver: ${testSolver ? 'âœ… åˆæœŸåŒ–æ¸ˆã¿' : 'âŒ æœªåˆæœŸåŒ–'}
â€¢ SimpleBitCSP: ${testSolver ? testSolver.constructor.name : 'æœªç¢ºèª'}

ğŸ“‹ åˆ©ç”¨å¯èƒ½ãƒ¡ã‚½ãƒƒãƒ‰:
${testSolver ? Object.getOwnPropertyNames(Object.getPrototypeOf(testSolver))
    .filter(name => name.includes('Phase4') || name.includes('Bit'))
    .map(name => 'â€¢ ' + name)
    .join('\n') : 'æœªç¢ºèª'}

ğŸ§ª ãƒ†ã‚¹ãƒˆå±¥æ­´:
${Object.keys(testResults).length > 0 ? 
    Object.keys(testResults).map(key => `â€¢ ${key}: å®Œäº†`).join('\n') : 
    'â€¢ ã¾ã ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã›ã‚“'
}

âš™ï¸ ãƒ–ãƒ©ã‚¦ã‚¶æƒ…å ±:
â€¢ UserAgent: ${navigator.userAgent}
â€¢ æ™‚åˆ»: ${new Date().toLocaleString()}
â€¢ ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: ${performance.memory ? 
    Math.round(performance.memory.usedJSHeapSize / 1024 / 1024) + 'MB' : 'æœªç¢ºèª'}`;
                
                debugDiv.textContent = debugInfo;
                debugDiv.style.display = 'block';
            } else {
                debugDiv.style.display = 'none';
            }
        }
    </script>
</body>
</html>