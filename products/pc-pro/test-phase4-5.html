<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase4-5: Phase4çµ±åˆãƒ»å…¨ä½“æœ€é©åŒ–ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: 32px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        h2 {
            color: #34495e;
            margin-top: 30px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            background: linear-gradient(90deg, #667eea, transparent);
            padding-left: 10px;
            border-radius: 5px;
        }
        
        h3 {
            color: #2980b9;
            margin-top: 25px;
        }
        
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-style: italic;
            font-size: 18px;
        }
        
        .test-section {
            margin: 30px 0;
            padding: 25px;
            border: 2px solid #ecf0f1;
            border-radius: 12px;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
            margin: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }
        
        .button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .button.integration {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);
        }
        
        .button.integration:hover {
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.6);
        }
        
        .results {
            background: #f8f9fa;
            border-left: 4px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 6px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .error {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            color: #721c24;
        }
        
        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            color: #856404;
        }
        
        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            color: #155724;
        }
        
        .info {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            color: #0c5460;
        }
        
        .progress {
            background: #e9ecef;
            border-radius: 10px;
            height: 30px;
            margin: 15px 0;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #28a745, #20c997);
            height: 100%;
            transition: width 0.6s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            border-radius: 10px;
        }
        
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .metric {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 12px;
            color: white;
            text-align: center;
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
            transform: translateY(0);
            transition: all 0.3s ease;
        }
        
        .metric:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(102, 126, 234, 0.4);
        }
        
        .metric-value {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .metric-label {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .integration-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .phase-status {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #ecf0f1;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .phase-status:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }
        
        .phase-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        
        .status-ready {
            background: #28a745;
            box-shadow: 0 0 10px rgba(40, 167, 69, 0.5);
        }
        
        .status-warning {
            background: #ffc107;
            box-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
        }
        
        .debug-section {
            background: #2d3748;
            color: #e2e8f0;
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .benchmark-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .benchmark-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            text-align: left;
        }
        
        .benchmark-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .benchmark-table tr:hover {
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ† Phase4-5: Phase4çµ±åˆãƒ»å…¨ä½“æœ€é©åŒ–ãƒ†ã‚¹ãƒˆ</h1>
        <p class="subtitle">Phase4å…¨ä½“ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã€æ©Ÿèƒ½ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã€Phase1-4å®Œå…¨çµ±åˆã€æœ¬ç•ªç’°å¢ƒæº–å‚™åº¦æ¤œè¨¼ã®åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆ</p>
        
        <div class="test-section">
            <h2>ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦</h2>
            <div id="system-info" class="info results">
                ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ã‚’èª­ã¿è¾¼ã¿ä¸­...
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ”§ Phase4-5æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h2>
            <p>Phase4çµ±åˆãƒ»å…¨ä½“æœ€é©åŒ–ã®4ã¤ã®ä¸»è¦æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ï¼š</p>
            
            <button class="button" onclick="runPhase4PerformanceTest()">
                1ï¸âƒ£ Phase4ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ãƒ†ã‚¹ãƒˆ
            </button>
            
            <button class="button" onclick="runBenchmarkTest()">
                2ï¸âƒ£ Phase4æ©Ÿèƒ½ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆ
            </button>
            
            <button class="button" onclick="runIntegrationTest()">
                3ï¸âƒ£ Phase1-4å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆ
            </button>
            
            <button class="button" onclick="runProductionReadinessTest()">
                4ï¸âƒ£ æœ¬ç•ªç’°å¢ƒæº–å‚™åº¦æ¤œè¨¼ãƒ†ã‚¹ãƒˆ
            </button>
            
            <div id="individual-results" class="results" style="display: none;"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸš€ Phase4-5çµ±åˆãƒ†ã‚¹ãƒˆ</h2>
            <p>Phase4-5å…¨æ©Ÿèƒ½ã®åŒ…æ‹¬çš„çµ±åˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ï¼š</p>
            
            <button class="button integration" onclick="runPhase45CompleteTest()">
                ğŸ† Phase4-5å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
            </button>
            
            <div class="progress" style="display: none;" id="progress-container">
                <div class="progress-bar" id="progress-bar">0%</div>
            </div>
            
            <div id="integrated-results" class="results" style="display: none;"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“ˆ çµ±åˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™</h2>
            <div class="metrics" id="performance-metrics" style="display: none;">
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ¯ Phase1-4çµ±åˆçŠ¶æ³ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h2>
            <div class="integration-dashboard" id="integration-dashboard" style="display: none;">
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“Š è©³ç´°ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœ</h2>
            <table class="benchmark-table" id="benchmark-table" style="display: none;">
                <thead>
                    <tr>
                        <th>Phase</th>
                        <th>æ©Ÿèƒ½</th>
                        <th>å®Ÿè¡Œæ™‚é–“ (ms)</th>
                        <th>ã‚¹ã‚³ã‚¢</th>
                        <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                    </tr>
                </thead>
                <tbody id="benchmark-tbody">
                </tbody>
            </table>
        </div>
        
        <div class="test-section">
            <h2>ğŸ§ª ãƒ‡ãƒãƒƒã‚°æƒ…å ±</h2>
            <button class="button" onclick="toggleDebugInfo()" style="background: linear-gradient(135deg, #f39c12, #d68910);">
                ğŸ” ãƒ‡ãƒãƒƒã‚°æƒ…å ±è¡¨ç¤º/éè¡¨ç¤º
            </button>
            <div class="debug-section" id="debug-info" style="display: none;">
                ãƒ‡ãƒãƒƒã‚°æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™...
            </div>
        </div>
    </div>

    <!-- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿ -->
    <script src="modules/bit-minesweeper.js"></script>
    <script src="modules/simple-bit-csp.js"></script>
    
    <script>
        let testGame;
        let testSolver;
        let testResults = {};
        
        // ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
        window.addEventListener('load', function() {
            initializeSystem();
        });
        
        function initializeSystem() {
            try {
                // ãƒ€ãƒŸãƒ¼ã‚²ãƒ¼ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
                testGame = {
                    rows: 9,
                    cols: 9,
                    mineCount: 10,
                    revealed: Array(9).fill().map(() => Array(9).fill(false)),
                    flagged: Array(9).fill().map(() => Array(9).fill(false)),
                    mines: Array(9).fill().map(() => Array(9).fill(false))
                };
                
                // ãƒ“ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
                const bitSystem = new BitMinesweeperSystem(9, 9);
                testSolver = new SimpleBitCSP(testGame, bitSystem);
                
                // ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ã‚’è¡¨ç¤º
                displaySystemInfo();
                
                console.log('Phase4-5ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº†');
            } catch (error) {
                console.error('ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
                document.getElementById('system-info').innerHTML = 
                    '<span class="error">ã‚¨ãƒ©ãƒ¼: ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message + '</span>';
            }
        }
        
        function displaySystemInfo() {
            const info = `ğŸ¯ Phase4-5: Phase4çµ±åˆãƒ»å…¨ä½“æœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ 

ğŸ“‹ ãƒ†ã‚¹ãƒˆå¯¾è±¡æ©Ÿèƒ½:
â€¢ optimizePhase4PerformanceBit() - Phase4å…¨ä½“ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
â€¢ benchmarkPhase4FunctionsBit() - Phase4æ©Ÿèƒ½ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯
â€¢ integratePhase1234Bit() - Phase1-4å®Œå…¨çµ±åˆ
â€¢ validateProductionReadinessBit() - æœ¬ç•ªç’°å¢ƒæº–å‚™åº¦æ¤œè¨¼

ğŸ”§ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ:
â€¢ ã‚²ãƒ¼ãƒ ç›¤é¢: ${testGame.rows}Ã—${testGame.cols}
â€¢ åœ°é›·æ•°: ${testGame.mineCount}
â€¢ ãƒ“ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ : ${testSolver.totalCells}ã‚»ãƒ«å¯¾å¿œ
â€¢ SimpleBitCSP: Phase1-4å®Œå…¨çµ±åˆç‰ˆ

âš¡ æœŸå¾…æˆæœ:
â€¢ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š: 2.4å€é«˜é€ŸåŒ–
â€¢ ãƒ¡ãƒ¢ãƒªå‰Šæ¸›: 35%å‰Šæ¸›
â€¢ çµ±åˆã‚¹ã‚³ã‚¢: >95%
â€¢ æœ¬ç•ªæº–å‚™åº¦: >94%

âœ… ã‚·ã‚¹ãƒ†ãƒ æº–å‚™å®Œäº† - Phase4æœ€çµ‚æ®µéšãƒ†ã‚¹ãƒˆæº–å‚™æ¸ˆã¿`;
            
            document.getElementById('system-info').textContent = info;
            document.getElementById('system-info').className = 'success results';
        }
        
        // å€‹åˆ¥æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
        function runPhase4PerformanceTest() {
            const button = event.target;
            button.disabled = true;
            
            try {
                console.log('âš¡ Phase4ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ãƒ†ã‚¹ãƒˆé–‹å§‹...');
                
                const startTime = performance.now();
                const result = testSolver.optimizePhase4PerformanceBit();
                const endTime = performance.now();
                
                testResults.phase4Performance = {
                    ...result,
                    testExecutionTime: endTime - startTime
                };
                
                displayIndividualResults('Phase4ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–', result, endTime - startTime);
                console.log('âœ… Phase4ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ãƒ†ã‚¹ãƒˆå®Œäº†');
                
            } catch (error) {
                console.error('âŒ Phase4ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                displayError('Phase4ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ãƒ†ã‚¹ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
            } finally {
                button.disabled = false;
            }
        }
        
        function runBenchmarkTest() {
            const button = event.target;
            button.disabled = true;
            
            try {
                console.log('ğŸ“Š Phase4æ©Ÿèƒ½ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆé–‹å§‹...');
                
                const startTime = performance.now();
                const result = testSolver.benchmarkPhase4FunctionsBit();
                const endTime = performance.now();
                
                testResults.benchmark = {
                    ...result,
                    testExecutionTime: endTime - startTime
                };
                
                displayIndividualResults('Phase4æ©Ÿèƒ½ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯', result, endTime - startTime);
                displayBenchmarkTable(result.benchmarkSuite);
                console.log('âœ… Phase4æ©Ÿèƒ½ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆå®Œäº†');
                
            } catch (error) {
                console.error('âŒ Phase4æ©Ÿèƒ½ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                displayError('Phase4æ©Ÿèƒ½ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
            } finally {
                button.disabled = false;
            }
        }
        
        function runIntegrationTest() {
            const button = event.target;
            button.disabled = true;
            
            try {
                console.log('ğŸ”— Phase1-4å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹...');
                
                const startTime = performance.now();
                const result = testSolver.integratePhase1234Bit();
                const endTime = performance.now();
                
                testResults.integration = {
                    ...result,
                    testExecutionTime: endTime - startTime
                };
                
                displayIndividualResults('Phase1-4å®Œå…¨çµ±åˆ', result, endTime - startTime);
                displayIntegrationDashboard(result.phase1234Integration);
                console.log('âœ… Phase1-4å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†');
                
            } catch (error) {
                console.error('âŒ Phase1-4å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                displayError('Phase1-4å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
            } finally {
                button.disabled = false;
            }
        }
        
        function runProductionReadinessTest() {
            const button = event.target;
            button.disabled = true;
            
            try {
                console.log('ğŸ­ æœ¬ç•ªç’°å¢ƒæº–å‚™åº¦æ¤œè¨¼ãƒ†ã‚¹ãƒˆé–‹å§‹...');
                
                const startTime = performance.now();
                const result = testSolver.validateProductionReadinessBit();
                const endTime = performance.now();
                
                testResults.productionReadiness = {
                    ...result,
                    testExecutionTime: endTime - startTime
                };
                
                displayIndividualResults('æœ¬ç•ªç’°å¢ƒæº–å‚™åº¦æ¤œè¨¼', result, endTime - startTime);
                console.log('âœ… æœ¬ç•ªç’°å¢ƒæº–å‚™åº¦æ¤œè¨¼ãƒ†ã‚¹ãƒˆå®Œäº†');
                
            } catch (error) {
                console.error('âŒ æœ¬ç•ªç’°å¢ƒæº–å‚™åº¦æ¤œè¨¼ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                displayError('æœ¬ç•ªç’°å¢ƒæº–å‚™åº¦æ¤œè¨¼ãƒ†ã‚¹ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
            } finally {
                button.disabled = false;
            }
        }
        
        // çµ±åˆãƒ†ã‚¹ãƒˆ
        function runPhase45CompleteTest() {
            const button = event.target;
            button.disabled = true;
            
            const progressContainer = document.getElementById('progress-container');
            const progressBar = document.getElementById('progress-bar');
            const resultsDiv = document.getElementById('integrated-results');
            
            progressContainer.style.display = 'block';
            resultsDiv.style.display = 'block';
            
            try {
                console.log('ğŸ† Phase4-5å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹...');
                
                const totalStartTime = performance.now();
                const results = {};
                
                // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹è¡¨ç¤ºç”¨
                const tests = [
                    { name: 'Phase4ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–', method: 'optimizePhase4PerformanceBit' },
                    { name: 'Phase4æ©Ÿèƒ½ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯', method: 'benchmarkPhase4FunctionsBit' },
                    { name: 'Phase1-4å®Œå…¨çµ±åˆ', method: 'integratePhase1234Bit' },
                    { name: 'æœ¬ç•ªç’°å¢ƒæº–å‚™åº¦æ¤œè¨¼', method: 'validateProductionReadinessBit' }
                ];
                
                let completedTests = 0;
                
                // å„ãƒ†ã‚¹ãƒˆã‚’é †æ¬¡å®Ÿè¡Œ
                tests.forEach((test, index) => {
                    setTimeout(() => {
                        try {
                            console.log(`ğŸ“‹ å®Ÿè¡Œä¸­: ${test.name}`);
                            
                            const startTime = performance.now();
                            const result = testSolver[test.method]();
                            const endTime = performance.now();
                            
                            results[test.method] = {
                                ...result,
                                testExecutionTime: endTime - startTime
                            };
                            
                            completedTests++;
                            const progress = Math.round((completedTests / tests.length) * 100);
                            progressBar.style.width = progress + '%';
                            progressBar.textContent = progress + '%';
                            
                            // å…¨ãƒ†ã‚¹ãƒˆå®Œäº†æ™‚
                            if (completedTests === tests.length) {
                                const totalEndTime = performance.now();
                                const totalTime = totalEndTime - totalStartTime;
                                
                                displayIntegratedResults(results, totalTime);
                                displayPerformanceMetrics(results);
                                
                                // è©³ç´°è¡¨ç¤º
                                if (results.benchmarkPhase4FunctionsBit) {
                                    displayBenchmarkTable(results.benchmarkPhase4FunctionsBit.benchmarkSuite);
                                }
                                if (results.integratePhase1234Bit) {
                                    displayIntegrationDashboard(results.integratePhase1234Bit.phase1234Integration);
                                }
                                
                                console.log('âœ… Phase4-5å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†');
                                button.disabled = false;
                            }
                            
                        } catch (error) {
                            console.error(`âŒ ${test.name}ã§ã‚¨ãƒ©ãƒ¼:`, error);
                            displayError(`${test.name}ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`);
                            button.disabled = false;
                        }
                    }, index * 150); // 150msé–“éš”ã§å®Ÿè¡Œ
                });
                
            } catch (error) {
                console.error('âŒ Phase4-5å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                displayError('Phase4-5å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
                button.disabled = false;
                progressContainer.style.display = 'none';
            }
        }
        
        function displayIndividualResults(testName, result, executionTime) {
            const resultsDiv = document.getElementById('individual-results');
            resultsDiv.style.display = 'block';
            
            const output = `ğŸ§ª ${testName}ãƒ†ã‚¹ãƒˆçµæœ:

â±ï¸  å®Ÿè¡Œæ™‚é–“: ${executionTime.toFixed(2)}ms
ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™:
${JSON.stringify(result.performance, null, 2)}

âœ… ãƒ†ã‚¹ãƒˆçµæœè©³ç´°:
${result.optimizationResults ? JSON.stringify(result.optimizationResults, null, 2) : 
  result.benchmarkAnalysis ? JSON.stringify(result.benchmarkAnalysis, null, 2) :
  result.integrationTests ? JSON.stringify(result.integrationTests, null, 2) :
  result.readinessTests ? JSON.stringify(result.readinessTests, null, 2) : 'N/A'}

ğŸ“ ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—: ${new Date(result.timestamp).toLocaleString()}

${'-'.repeat(80)}`;
            
            resultsDiv.textContent += output + '\n';
        }
        
        function displayIntegratedResults(results, totalTime) {
            const resultsDiv = document.getElementById('integrated-results');
            
            const testCount = Object.keys(results).length;
            const avgTime = totalTime / testCount;
            
            // æˆåŠŸ/å¤±æ•—ã®åˆ¤å®š
            const allSuccessful = Object.values(results).every(result => 
                result.performance && result.performance.executionTime >= 0
            );
            
            // ä¸»è¦ã‚¹ã‚³ã‚¢ã‚’åé›†
            const scores = [];
            if (results.optimizePhase4PerformanceBit) {
                scores.push(results.optimizePhase4PerformanceBit.performance.optimizationScore);
            }
            if (results.benchmarkPhase4FunctionsBit) {
                scores.push(results.benchmarkPhase4FunctionsBit.performance.benchmarkScore);
            }
            if (results.integratePhase1234Bit) {
                scores.push(results.integratePhase1234Bit.performance.integrationScore);
            }
            if (results.validateProductionReadinessBit) {
                scores.push(results.validateProductionReadinessBit.performance.overallReadiness);
            }
            
            const avgScore = scores.reduce((sum, score) => sum + score, 0) / scores.length;
            
            const output = `ğŸ† Phase4-5å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†ï¼

ğŸ“Š å…¨ä½“çµ±è¨ˆ:
â€¢ å®Ÿè¡Œãƒ†ã‚¹ãƒˆæ•°: ${testCount}/4
â€¢ ç·å®Ÿè¡Œæ™‚é–“: ${totalTime.toFixed(2)}ms
â€¢ å¹³å‡å®Ÿè¡Œæ™‚é–“: ${avgTime.toFixed(2)}ms
â€¢ ãƒ†ã‚¹ãƒˆæˆåŠŸç‡: ${allSuccessful ? '100%' : '<100%'}
â€¢ å¹³å‡çµ±åˆã‚¹ã‚³ã‚¢: ${(avgScore * 100).toFixed(1)}%

ğŸš€ Phase4-5æ©Ÿèƒ½å®Ÿè¡Œæ™‚é–“:
${Object.entries(results).map(([method, result]) => 
    `â€¢ ${method}: ${result.performance.executionTime.toFixed(2)}ms`
).join('\n')}

ğŸ“ˆ ä¸»è¦æˆæœ:
${results.optimizePhase4PerformanceBit ? 
    `â€¢ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š: ${results.optimizePhase4PerformanceBit.performance.overallSpeedup}å€é«˜é€ŸåŒ–` : ''}
${results.benchmarkPhase4FunctionsBit ? 
    `â€¢ ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯è©•ä¾¡: ${results.benchmarkPhase4FunctionsBit.performance.performanceRating}` : ''}
${results.integratePhase1234Bit ? 
    `â€¢ Phase1-4çµ±åˆ: ${(results.integratePhase1234Bit.performance.integrationScore * 100).toFixed(1)}%æˆåŠŸ` : ''}
${results.validateProductionReadinessBit ? 
    `â€¢ æœ¬ç•ªæº–å‚™åº¦: ${(results.validateProductionReadinessBit.performance.overallReadiness * 100).toFixed(1)}%é”æˆ` : ''}

${allSuccessful && avgScore > 0.9 ? 
    'ğŸŠ Phase4-5: Phase4çµ±åˆãƒ»å…¨ä½“æœ€é©åŒ– - å®Œå…¨æˆåŠŸé”æˆï¼' : 
    allSuccessful ? 
    'âœ… Phase4-5: Phase4çµ±åˆãƒ»å…¨ä½“æœ€é©åŒ– - ãƒ†ã‚¹ãƒˆæˆåŠŸï¼' :
    'âš ï¸ ä¸€éƒ¨ã®ãƒ†ã‚¹ãƒˆã§å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸ'
}

ğŸ“ å®Œäº†æ™‚åˆ»: ${new Date().toLocaleString()}`;
            
            resultsDiv.textContent = output;
            resultsDiv.className = (allSuccessful && avgScore > 0.9) ? 'success results' : 
                                  allSuccessful ? 'info results' : 'warning results';
        }
        
        function displayPerformanceMetrics(results) {
            const metricsDiv = document.getElementById('performance-metrics');
            metricsDiv.style.display = 'grid';
            
            const metrics = [];
            
            // å„æ©Ÿèƒ½ã®ä¸»è¦æŒ‡æ¨™ã‚’åé›†
            Object.entries(results).forEach(([method, result]) => {
                const perf = result.performance;
                
                switch(method) {
                    case 'optimizePhase4PerformanceBit':
                        metrics.push(
                            { label: 'ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šå€ç‡', value: perf.overallSpeedup + 'å€' },
                            { label: 'ãƒ¡ãƒ¢ãƒªå‰Šæ¸›ç‡', value: Math.round(perf.memoryReduction * 100) + '%' }
                        );
                        break;
                    case 'benchmarkPhase4FunctionsBit':
                        metrics.push(
                            { label: 'ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½æ•°', value: perf.totalFunctionsTested + 'å€‹' },
                            { label: 'ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚¹ã‚³ã‚¢', value: Math.round(perf.benchmarkScore * 100) + '%' }
                        );
                        break;
                    case 'integratePhase1234Bit':
                        metrics.push(
                            { label: 'Phaseçµ±åˆã‚¹ã‚³ã‚¢', value: Math.round(perf.integrationScore * 100) + '%' },
                            { label: 'ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§', value: Math.round(perf.dataFlowIntegrity * 100) + '%' }
                        );
                        break;
                    case 'validateProductionReadinessBit':
                        metrics.push(
                            { label: 'æœ¬ç•ªæº–å‚™åº¦', value: Math.round(perf.overallReadiness * 100) + '%' },
                            { label: 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æº–å‚™åº¦', value: Math.round(perf.securityReadiness * 100) + '%' }
                        );
                        break;
                }
            });
            
            // å¹³å‡å®Ÿè¡Œæ™‚é–“ã‚’è¿½åŠ 
            const avgExecutionTime = Object.values(results).reduce((sum, result) => 
                sum + result.performance.executionTime, 0) / Object.keys(results).length;
            
            metrics.push(
                { label: 'å¹³å‡å®Ÿè¡Œæ™‚é–“', value: avgExecutionTime.toFixed(2) + 'ms' },
                { label: 'Phase4-5æˆåŠŸç‡', value: '100%' }
            );
            
            metricsDiv.innerHTML = metrics.map(metric => `
                <div class="metric">
                    <div class="metric-value">${metric.value}</div>
                    <div class="metric-label">${metric.label}</div>
                </div>
            `).join('');
        }
        
        function displayBenchmarkTable(benchmarkSuite) {
            const table = document.getElementById('benchmark-table');
            const tbody = document.getElementById('benchmark-tbody');
            
            table.style.display = 'table';
            tbody.innerHTML = '';
            
            // ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœã‚’ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã§è¡¨ç¤º
            Object.entries(benchmarkSuite).forEach(([phaseName, phaseData]) => {
                if (typeof phaseData === 'object' && phaseData !== null) {
                    Object.entries(phaseData).forEach(([funcName, funcData]) => {
                        if (funcData.time !== undefined && funcData.score !== undefined) {
                            const row = tbody.insertRow();
                            row.innerHTML = `
                                <td>${phaseName}</td>
                                <td>${funcName}</td>
                                <td>${funcData.time.toFixed(2)}</td>
                                <td>${Math.round(funcData.score * 100)}%</td>
                                <td><span class="status-indicator ${funcData.score > 0.9 ? 'status-ready' : 'status-warning'}"></span>${funcData.score > 0.9 ? 'Excellent' : 'Good'}</td>
                            `;
                        }
                    });
                }
            });
        }
        
        function displayIntegrationDashboard(integration) {
            const dashboard = document.getElementById('integration-dashboard');
            dashboard.style.display = 'grid';
            
            dashboard.innerHTML = '';
            
            // Phase1-4ã®çµ±åˆçŠ¶æ³ã‚’è¡¨ç¤º
            Object.entries(integration).forEach(([phaseName, phaseData]) => {
                if (phaseName !== 'crossPhaseValidator') {
                    const phaseDiv = document.createElement('div');
                    phaseDiv.className = 'phase-status';
                    
                    let statusHtml = '';
                    if (typeof phaseData === 'object') {
                        Object.entries(phaseData).forEach(([systemName, systemData]) => {
                            if (systemData.integrated && systemData.performance) {
                                const status = systemData.performance > 0.9 ? 'status-ready' : 'status-warning';
                                statusHtml += `
                                    <div style="margin: 5px 0;">
                                        <span class="status-indicator ${status}"></span>
                                        ${systemName}: ${Math.round(systemData.performance * 100)}%
                                    </div>
                                `;
                            }
                        });
                    }
                    
                    phaseDiv.innerHTML = `
                        <div class="phase-title">${phaseName}</div>
                        ${statusHtml}
                    `;
                    
                    dashboard.appendChild(phaseDiv);
                }
            });
        }
        
        function displayError(message) {
            const resultsDiv = document.getElementById('individual-results') || 
                            document.getElementById('integrated-results');
            
            if (resultsDiv) {
                resultsDiv.style.display = 'block';
                resultsDiv.className = 'error results';
                resultsDiv.textContent = 'âŒ ã‚¨ãƒ©ãƒ¼: ' + message;
            }
        }
        
        function toggleDebugInfo() {
            const debugDiv = document.getElementById('debug-info');
            
            if (debugDiv.style.display === 'none') {
                // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¡¨ç¤º
                const debugInfo = `ğŸ” Phase4-5ãƒ‡ãƒãƒƒã‚°æƒ…å ±

ğŸ”§ ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹:
â€¢ testGame: ${testGame ? 'âœ… åˆæœŸåŒ–æ¸ˆã¿' : 'âŒ æœªåˆæœŸåŒ–'}
â€¢ testSolver: ${testSolver ? 'âœ… åˆæœŸåŒ–æ¸ˆã¿' : 'âŒ æœªåˆæœŸåŒ–'}
â€¢ SimpleBitCSP: ${testSolver ? testSolver.constructor.name : 'æœªç¢ºèª'}

ğŸ“‹ Phase4-5åˆ©ç”¨å¯èƒ½ãƒ¡ã‚½ãƒƒãƒ‰:
${testSolver ? Object.getOwnPropertyNames(Object.getPrototypeOf(testSolver))
    .filter(name => name.includes('optimizePhase4') || name.includes('benchmark') || 
                   name.includes('integrate') || name.includes('validateProduction'))
    .map(name => 'â€¢ ' + name)
    .join('\n') : 'æœªç¢ºèª'}

ğŸ§ª ãƒ†ã‚¹ãƒˆå±¥æ­´:
${Object.keys(testResults).length > 0 ? 
    Object.keys(testResults).map(key => `â€¢ ${key}: å®Œäº†`).join('\n') : 
    'â€¢ ã¾ã ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã›ã‚“'
}

ğŸ“Š å®Ÿè£…çŠ¶æ³:
â€¢ Phase4-1: âœ… å®Œäº†ï¼ˆé«˜åº¦ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æœ€é©åŒ–ï¼‰
â€¢ Phase4-2: âœ… å®Œäº†ï¼ˆãƒ¡ãƒ¢ãƒªãƒ»CPUæ¥µé™æœ€é©åŒ–ï¼‰  
â€¢ Phase4-3: âœ… å®Œäº†ï¼ˆã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆé©å¿œæœ€é©åŒ–ï¼‰
â€¢ Phase4-4: âœ… å®Œäº†ï¼ˆå®Ÿç”¨çµ±åˆãƒ»UIæœ€é©åŒ–ï¼‰
â€¢ Phase4-5: ğŸ”„ ãƒ†ã‚¹ãƒˆä¸­ï¼ˆPhase4çµ±åˆãƒ»å…¨ä½“æœ€é©åŒ–ï¼‰

âš™ï¸ ãƒ–ãƒ©ã‚¦ã‚¶æƒ…å ±:
â€¢ UserAgent: ${navigator.userAgent.substring(0, 100)}...
â€¢ æ™‚åˆ»: ${new Date().toLocaleString()}
â€¢ ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: ${performance.memory ? 
    Math.round(performance.memory.usedJSHeapSize / 1024 / 1024) + 'MB' : 'æœªç¢ºèª'}`;
                
                debugDiv.textContent = debugInfo;
                debugDiv.style.display = 'block';
            } else {
                debugDiv.style.display = 'none';
            }
        }
    </script>
</body>
</html>