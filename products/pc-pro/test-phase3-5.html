<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase3-5: Phase3çµ±åˆãƒ»å…¨ä½“æœ€é©åŒ–ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            background-color: #1a1a1a;
            color: #e0e0e0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .header {
            background: linear-gradient(135deg, #9C27B0 0%, #673AB7 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        .test-section {
            background-color: #2d2d2d;
            border: 1px solid #555;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
        .warning { color: #ff9800; }
        .info { color: #2196F3; }
        .excellent { color: #00E676; }
        .good { color: #66BB6A; }
        .acceptable { color: #FFA726; }
        .needs_improvement { color: #FF7043; }
        .test-button {
            background: linear-gradient(45deg, #9C27B0, #673AB7);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: all 0.3s;
        }
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(156, 39, 176, 0.4);
        }
        .integration-button {
            background: linear-gradient(45deg, #FF5722, #E64A19);
            font-weight: bold;
            font-size: 18px;
            padding: 15px 30px;
        }
        .test-results {
            background-color: #1e1e1e;
            border: 1px solid #333;
            border-radius: 6px;
            padding: 15px;
            margin-top: 15px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            max-height: 500px;
            overflow-y: auto;
        }
        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .metric-card {
            background-color: #333;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #9C27B0;
        }
        .metric-label {
            font-size: 14px;
            color: #bbb;
            margin-top: 5px;
        }
        .benchmark-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .benchmark-table th, .benchmark-table td {
            border: 1px solid #555;
            padding: 8px;
            text-align: left;
        }
        .benchmark-table th {
            background-color: #444;
            color: #9C27B0;
        }
        .integration-status {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        .status-item {
            background-color: #2a2a2a;
            border: 1px solid #555;
            border-radius: 6px;
            padding: 10px;
            margin: 5px;
            min-width: 120px;
            text-align: center;
        }
        .status-indicator {
            font-size: 24px;
            margin-bottom: 5px;
        }
        .optimization-summary {
            background: linear-gradient(135deg, #263238 0%, #37474F 100%);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ Phase3-5: Phase3çµ±åˆãƒ»å…¨ä½“æœ€é©åŒ–</h1>
            <p>ç›®æ¨™: Phase3å…¨æ©Ÿèƒ½ã®çµ±åˆã¨Phase1-2-3å®Œå…¨é€£æº</p>
            <p>æ©Ÿèƒ½: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ãƒ»æ©Ÿèƒ½ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ»ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰çµ±åˆ</p>
        </div>

        <div class="test-section">
            <h2>ğŸ“‹ Phase3-5 æ ¸å¿ƒæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h2>
            <button class="test-button" onclick="testOptimizePhase3Performance()">1. optimizePhase3PerformanceBit() ãƒ†ã‚¹ãƒˆ</button>
            <button class="test-button" onclick="testBenchmarkPhase3Functions()">2. benchmarkPhase3FunctionsBit() ãƒ†ã‚¹ãƒˆ</button>
            <button class="test-button integration-button" onclick="testIntegratePhase123()">ğŸ¯ 3. integratePhase123Bit() çµ±åˆãƒ†ã‚¹ãƒˆ</button>
            <button class="test-button" onclick="runAllPhase35Tests()">ğŸš€ å…¨Phase3-5ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <button class="test-button" onclick="clearResults()" style="background: linear-gradient(45deg, #f44336, #d32f2f);">ğŸ§¹ çµæœã‚¯ãƒªã‚¢</button>
            <div id="testResults" class="test-results"></div>
        </div>

        <div class="test-section">
            <h2>âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–çµæœ</h2>
            <div id="optimizationSummary" class="optimization-summary">
                <p>æœ€é©åŒ–ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå¾Œã€ã“ã“ã«çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™</p>
            </div>
            <div id="performanceMetrics" class="performance-grid"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ“Š Phase3æ©Ÿèƒ½ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯</h2>
            <button class="test-button" onclick="showDetailedBenchmark()">è©³ç´°ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯è¡¨ç¤º</button>
            <div id="benchmarkResults" class="test-results"></div>
            <table id="benchmarkTable" class="benchmark-table" style="display: none;">
                <thead>
                    <tr>
                        <th>æ©Ÿèƒ½å</th>
                        <th>å¹³å‡å®Ÿè¡Œæ™‚é–“</th>
                        <th>æˆåŠŸç‡</th>
                        <th>Phase2æ¯”è¼ƒ</th>
                        <th>è©•ä¾¡</th>
                    </tr>
                </thead>
                <tbody id="benchmarkTableBody"></tbody>
            </table>
        </div>

        <div class="test-section">
            <h2>ğŸ”— Phase1-2-3çµ±åˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</h2>
            <div id="integrationStatus" class="integration-status">
                <div class="status-item">
                    <div class="status-indicator" id="phase1Status">â³</div>
                    <div>Phase1çµ±åˆ</div>
                </div>
                <div class="status-item">
                    <div class="status-indicator" id="phase2Status">â³</div>
                    <div>Phase2çµ±åˆ</div>
                </div>
                <div class="status-item">
                    <div class="status-indicator" id="phase3Status">â³</div>
                    <div>Phase3çµ±åˆ</div>
                </div>
                <div class="status-item">
                    <div class="status-indicator" id="endToEndStatus">â³</div>
                    <div>End-to-End</div>
                </div>
                <div class="status-item">
                    <div class="status-indicator" id="performanceStatus">â³</div>
                    <div>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</div>
                </div>
            </div>
            <div id="integrationDetails" class="test-results"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ¯ Phase3å®Œæˆåº¦è©•ä¾¡</h2>
            <div id="completionAssessment" class="test-results">
                çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œå¾Œã€Phase3ã®å®Œæˆåº¦è©•ä¾¡ãŒè¡¨ç¤ºã•ã‚Œã¾ã™
            </div>
        </div>
    </div>

    <script src="modules/bit-minesweeper.js"></script>
    <script src="modules/simple-bit-csp.js"></script>
    <script>
        let testResults, benchmarkResults, integrationDetails, completionAssessment;
        let optimizationSummary, performanceMetrics, benchmarkTable, benchmarkTableBody;
        let mockGame, bitSystem, bitCSP;

        // DOMãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã‹ã‚‰åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            testResults = document.getElementById('testResults');
            benchmarkResults = document.getElementById('benchmarkResults');
            integrationDetails = document.getElementById('integrationDetails');
            completionAssessment = document.getElementById('completionAssessment');
            optimizationSummary = document.getElementById('optimizationSummary');
            performanceMetrics = document.getElementById('performanceMetrics');
            benchmarkTable = document.getElementById('benchmarkTable');
            benchmarkTableBody = document.getElementById('benchmarkTableBody');

            // ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ¢ãƒƒã‚¯ã‚²ãƒ¼ãƒ ç’°å¢ƒ
            mockGame = {
                rows: 16,
                cols: 16,
                mines: 40,
                board: Array(16).fill().map(() => Array(16).fill(0)),
                isValidCoord: (row, col) => row >= 0 && row < 16 && col >= 0 && col < 16
            };

            // BitMinesweeperSystemã¨SimpleBitCSPã‚’åˆæœŸåŒ–
            try {
                bitSystem = new BitMinesweeperSystem(mockGame);
                bitCSP = new SimpleBitCSP(mockGame, bitSystem);
                log("ğŸš€ Phase3-5ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº†", testResults, 'success');
                log("Phase3çµ±åˆãƒ»å…¨ä½“æœ€é©åŒ–ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™", testResults, 'info');
            } catch (error) {
                console.error('åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
                if (testResults) {
                    log(`âŒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ${error.message}`, testResults, 'error');
                }
            }
        });

        function log(message, element = testResults, className = '') {
            const timestamp = new Date().toLocaleTimeString();
            const logMessage = `[${timestamp}] ${message}\n`;
            element.textContent += logMessage;
            if (className) {
                element.className += ` ${className}`;
            }
            element.scrollTop = element.scrollHeight;
        }

        function clearResults() {
            testResults.textContent = '';
            benchmarkResults.textContent = '';
            integrationDetails.textContent = '';
            completionAssessment.textContent = '';
            performanceMetrics.innerHTML = '';
            benchmarkTableBody.innerHTML = '';
            benchmarkTable.style.display = 'none';
            optimizationSummary.innerHTML = '<p>æœ€é©åŒ–ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå¾Œã€ã“ã“ã«çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™</p>';
            
            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºã‚’ãƒªã‚»ãƒƒãƒˆ
            ['phase1Status', 'phase2Status', 'phase3Status', 'endToEndStatus', 'performanceStatus'].forEach(id => {
                document.getElementById(id).textContent = 'â³';
            });
        }

        // 1. optimizePhase3PerformanceBit() ãƒ†ã‚¹ãƒˆ
        function testOptimizePhase3Performance() {
            log("=== optimizePhase3PerformanceBit() ãƒ†ã‚¹ãƒˆé–‹å§‹ ===", testResults, 'info');
            
            if (!bitCSP) {
                log("âŒ bitCSP ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚", testResults, 'error');
                return false;
            }
            
            try {
                const result = bitCSP.optimizePhase3PerformanceBit();
                
                log(`${result.success ? 'âœ…' : 'âŒ'} Phase3ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–: ${result.success ? 'æˆåŠŸ' : 'å¤±æ•—'}`, testResults, 
                    result.success ? 'success' : 'error');
                
                if (result.success) {
                    log(`   - å®Ÿè¡Œæ™‚é–“: ${result.executionTime.toFixed(4)}ms`, testResults);
                    log(`   - ãƒ¡ãƒ¢ãƒªå‰Šæ¸›: ${result.improvementSummary.memoryReduction}`, testResults);
                    log(`   - é€Ÿåº¦æ”¹å–„: ${result.improvementSummary.speedImprovement}`, testResults);
                    log(`   - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡: ${result.improvementSummary.cacheHitRate}`, testResults);
                    
                    // æœ€é©åŒ–çµæœã®è©³ç´°è¡¨ç¤º
                    displayOptimizationSummary(result);
                    
                    // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹è¡¨ç¤º
                    updatePerformanceMetrics({
                        'memory_reduction': {
                            value: result.improvementSummary.memoryReduction,
                            label: 'ãƒ¡ãƒ¢ãƒªå‰Šæ¸›'
                        },
                        'speed_improvement': {
                            value: result.improvementSummary.speedImprovement,
                            label: 'é€Ÿåº¦æ”¹å–„'
                        },
                        'cache_hit_rate': {
                            value: result.improvementSummary.cacheHitRate,
                            label: 'ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡'
                        },
                        'execution_time': {
                            value: `${result.executionTime.toFixed(4)}ms`,
                            label: 'å®Ÿè¡Œæ™‚é–“'
                        }
                    });
                } else {
                    log(`   - å¤±æ•—ç†ç”±: ${result.reason}`, testResults, 'error');
                    if (result.error) log(`   - ã‚¨ãƒ©ãƒ¼: ${result.error}`, testResults, 'error');
                }
                
                return result.success;

            } catch (error) {
                log(`âŒ optimizePhase3PerformanceBit() ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, testResults, 'error');
                return false;
            }
        }

        // 2. benchmarkPhase3FunctionsBit() ãƒ†ã‚¹ãƒˆ
        function testBenchmarkPhase3Functions() {
            log("=== benchmarkPhase3FunctionsBit() ãƒ†ã‚¹ãƒˆé–‹å§‹ ===", testResults, 'info');
            
            if (!bitCSP) {
                log("âŒ bitCSP ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚", testResults, 'error');
                return false;
            }
            
            try {
                const result = bitCSP.benchmarkPhase3FunctionsBit();
                
                log(`${result.success ? 'âœ…' : 'âŒ'} Phase3æ©Ÿèƒ½ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯: ${result.success ? 'æˆåŠŸ' : 'å¤±æ•—'}`, testResults,
                    result.success ? 'success' : 'error');
                
                if (result.success) {
                    log(`   - å®Ÿè¡Œæ™‚é–“: ${result.executionTime.toFixed(4)}ms`, testResults);
                    log(`   - å¹³å‡å®Ÿè¡Œæ™‚é–“: ${result.summary.averageExecutionTime.toFixed(4)}ms`, testResults);
                    log(`   - æœ€é«˜é€Ÿæ©Ÿèƒ½: ${result.summary.fastestFunction}`, testResults);
                    log(`   - æœ€ä½é€Ÿæ©Ÿèƒ½: ${result.summary.slowestFunction}`, testResults);
                    log(`   - ç·åˆè©•ä¾¡: ${result.summary.overallRating}ç‚¹`, testResults);
                    
                    // ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœè©³ç´°
                    log("\n--- ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯è©³ç´°çµæœ ---", benchmarkResults, 'info');
                    for (const [funcName, metrics] of Object.entries(result.benchmark.functions)) {
                        log(`${funcName}:`, benchmarkResults);
                        log(`  å¹³å‡: ${metrics.averageTime.toFixed(4)}ms`, benchmarkResults);
                        log(`  æˆåŠŸç‡: ${metrics.successRate.toFixed(1)}%`, benchmarkResults);
                        log(`  ç¯„å›²: ${metrics.minTime.toFixed(4)}ms - ${metrics.maxTime.toFixed(4)}ms`, benchmarkResults);
                    }
                    
                    // ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã§ã‚‚è¡¨ç¤º
                    displayBenchmarkTable(result.benchmark);
                } else {
                    log(`   - å¤±æ•—ç†ç”±: ${result.reason}`, testResults, 'error');
                    if (result.error) log(`   - ã‚¨ãƒ©ãƒ¼: ${result.error}`, testResults, 'error');
                }
                
                return result.success;

            } catch (error) {
                log(`âŒ benchmarkPhase3FunctionsBit() ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, testResults, 'error');
                return false;
            }
        }

        // 3. integratePhase123Bit() ãƒ†ã‚¹ãƒˆ
        function testIntegratePhase123() {
            log("=== integratePhase123Bit() çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹ ===", testResults, 'info');
            
            if (!bitCSP) {
                log("âŒ bitCSP ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚", testResults, 'error');
                return false;
            }
            
            try {
                const result = bitCSP.integratePhase123Bit();
                
                log(`${result.success ? 'âœ…' : 'âŒ'} Phase1-2-3å®Œå…¨çµ±åˆ: ${result.success ? 'æˆåŠŸ' : 'å¤±æ•—'}`, testResults,
                    result.success ? 'success' : 'error');
                
                if (result.success) {
                    log(`   - å®Ÿè¡Œæ™‚é–“: ${result.executionTime.toFixed(4)}ms`, testResults);
                    log(`   - å…¨Phaseçµ±åˆ: ${result.summary.allPhasesIntegrated ? 'ã¯ã„' : 'ã„ã„ãˆ'}`, testResults);
                    log(`   - End-to-Endå‹•ä½œ: ${result.summary.endToEndWorking ? 'OK' : 'NG'}`, testResults);
                    log(`   - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™: ${result.summary.performanceTargetMet ? 'é”æˆ' : 'æœªé”æˆ'}`, testResults);
                    log(`   - çµ±åˆè©•ä¾¡: ${result.summary.overallRating}`, testResults, getRatingClass(result.summary.overallRating));
                    
                    // çµ±åˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
                    updateIntegrationStatus(result.integration);
                    
                    // çµ±åˆè©³ç´°è¡¨ç¤º
                    displayIntegrationDetails(result.integration);
                    
                    // å®Œæˆåº¦è©•ä¾¡è¡¨ç¤º
                    displayCompletionAssessment(result);
                } else {
                    log(`   - å¤±æ•—ç†ç”±: ${result.reason}`, testResults, 'error');
                    if (result.details) {
                        log(`   - è©³ç´°: ${JSON.stringify(result.details, null, 2)}`, testResults, 'error');
                    }
                }
                
                return result.success;

            } catch (error) {
                log(`âŒ integratePhase123Bit() ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, testResults, 'error');
                return false;
            }
        }

        // å…¨Phase3-5ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        function runAllPhase35Tests() {
            log("ğŸš€ Phase3-5 å…¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆé–‹å§‹", testResults, 'info');
            log("=" * 60, testResults);
            
            let allPassed = true;
            const tests = [
                { name: "optimizePhase3PerformanceBit()", func: testOptimizePhase3Performance },
                { name: "benchmarkPhase3FunctionsBit()", func: testBenchmarkPhase3Functions },
                { name: "integratePhase123Bit()", func: testIntegratePhase123 }
            ];

            for (const test of tests) {
                log(`\n--- ${test.name} ãƒ†ã‚¹ãƒˆ ---`, testResults, 'info');
                const passed = test.func();
                allPassed = allPassed && passed;
                log(`${test.name}: ${passed ? 'âœ… æˆåŠŸ' : 'âŒ å¤±æ•—'}`, testResults, passed ? 'success' : 'error');
            }

            log("\n" + "=" * 60, testResults);
            log(`ğŸ¯ Phase3-5 å…¨ãƒ†ã‚¹ãƒˆçµæœ: ${allPassed ? 'âœ… å…¨ã¦æˆåŠŸ' : 'âŒ ä¸€éƒ¨å¤±æ•—'}`, testResults, 
                allPassed ? 'success' : 'error');
            
            if (allPassed) {
                log("ğŸ‰ Phase3-5 å®Œäº†ï¼Phase3çµ±åˆãƒ»å…¨ä½“æœ€é©åŒ–ãŒå®Œæˆã—ã¾ã—ãŸï¼", testResults, 'success');
                log("ğŸ‘‰ æ¬¡ã¯ Phase3-6: Phase3å®Œæˆãƒ»Phase4æº–å‚™ ã®å®Ÿè£…ã«é€²ã‚“ã§ãã ã•ã„", testResults, 'info');
            }
            
            return allPassed;
        }

        // æœ€é©åŒ–ã‚µãƒãƒªãƒ¼è¡¨ç¤º
        function displayOptimizationSummary(result) {
            const optimization = result.optimization;
            let summaryHTML = '<h3>ğŸ”§ æœ€é©åŒ–å®Ÿè¡Œçµæœ</h3>';
            
            summaryHTML += `<p><strong>ãƒ¡ãƒ¢ãƒªæœ€é©åŒ–:</strong></p>`;
            summaryHTML += `<p>  â€¢ å‰Šæ¸›å‰: ${optimization.memoryOptimization.beforeMB.toFixed(2)}MB</p>`;
            summaryHTML += `<p>  â€¢ å‰Šæ¸›å¾Œ: ${optimization.memoryOptimization.afterMB.toFixed(2)}MB</p>`;
            summaryHTML += `<p>  â€¢ å‰Šæ¸›é‡: ${optimization.memoryOptimization.savedMB.toFixed(2)}MB</p>`;
            
            summaryHTML += `<p><strong>ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æœ€é©åŒ–:</strong></p>`;
            summaryHTML += `<p>  â€¢ ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ€é©åŒ–: ${optimization.algorithmOptimization.cacheOptimization ? 'æœ‰åŠ¹' : 'ç„¡åŠ¹'}</p>`;
            summaryHTML += `<p>  â€¢ ãƒ“ãƒƒãƒˆæ¼”ç®—æœ€é©åŒ–: ${optimization.algorithmOptimization.bitOperationOptimization ? 'æœ‰åŠ¹' : 'ç„¡åŠ¹'}</p>`;
            summaryHTML += `<p>  â€¢ æ”¹å–„æ¨å®š: ${optimization.algorithmOptimization.improvementEstimate}</p>`;
            
            summaryHTML += `<p><strong>å…¨ä½“æ”¹å–„:</strong></p>`;
            summaryHTML += `<p>  â€¢ ç·åˆã‚¹ã‚³ã‚¢: ${optimization.overallImprovement.overallScore.toFixed(1)}ç‚¹</p>`;
            
            optimizationSummary.innerHTML = summaryHTML;
        }

        // ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤º
        function displayBenchmarkTable(benchmark) {
            benchmarkTableBody.innerHTML = '';
            
            for (const [funcName, metrics] of Object.entries(benchmark.functions)) {
                const row = benchmarkTableBody.insertRow();
                row.insertCell(0).textContent = funcName;
                row.insertCell(1).textContent = `${metrics.averageTime.toFixed(4)}ms`;
                row.insertCell(2).textContent = `${metrics.successRate.toFixed(1)}%`;
                
                // Phase2æ¯”è¼ƒ
                const comparison = benchmark.comparisons[funcName];
                const comparisonCell = row.insertCell(3);
                if (comparison) {
                    comparisonCell.textContent = `${comparison.improvementPercent.toFixed(1)}%`;
                    comparisonCell.className = comparison.verdict === 'improved' ? 'success' : 'warning';
                } else {
                    comparisonCell.textContent = 'N/A';
                }
                
                // è©•ä¾¡
                const ratingCell = row.insertCell(4);
                const rating = metrics.successRate >= 90 && metrics.averageTime < 5 ? 'excellent' :
                              metrics.successRate >= 80 && metrics.averageTime < 10 ? 'good' : 'needs_improvement';
                ratingCell.textContent = rating;
                ratingCell.className = rating;
            }
            
            benchmarkTable.style.display = 'table';
        }

        // çµ±åˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
        function updateIntegrationStatus(integration) {
            document.getElementById('phase1Status').textContent = 
                integration.phase1Integration.success ? 'âœ…' : 'âŒ';
            document.getElementById('phase2Status').textContent = 
                integration.phase2Integration.success ? 'âœ…' : 'âŒ';
            document.getElementById('phase3Status').textContent = 
                integration.phase3Integration.success ? 'âœ…' : 'âŒ';
            document.getElementById('endToEndStatus').textContent = 
                integration.endToEndTest.success ? 'âœ…' : 'âŒ';
            document.getElementById('performanceStatus').textContent = 
                integration.performanceTest.targetMet ? 'âœ…' : 'âš ï¸';
        }

        // çµ±åˆè©³ç´°è¡¨ç¤º
        function displayIntegrationDetails(integration) {
            let details = "=== çµ±åˆãƒ†ã‚¹ãƒˆè©³ç´°çµæœ ===\n";
            
            details += `Phase1çµ±åˆãƒ†ã‚¹ãƒˆ: ${integration.phase1Integration.success ? 'æˆåŠŸ' : 'å¤±æ•—'}\n`;
            if (integration.phase1Integration.success) {
                details += `  - å¢ƒç•Œã‚»ãƒ«æ¤œå‡º: ${integration.phase1Integration.boundaryTest ? 'OK' : 'NG'}\n`;
                details += `  - åˆ¶ç´„ç”Ÿæˆ: ${integration.phase1Integration.constraintTest ? 'OK' : 'NG'}\n`;
            }
            
            details += `\nPhase2çµ±åˆãƒ†ã‚¹ãƒˆ: ${integration.phase2Integration.success ? 'æˆåŠŸ' : 'å¤±æ•—'}\n`;
            if (integration.phase2Integration.success) {
                details += `  - éƒ¨åˆ†é›†åˆæ¤œå‡º: ${integration.phase2Integration.subsetTest ? 'OK' : 'NG'}\n`;
            }
            
            details += `\nPhase3çµ±åˆãƒ†ã‚¹ãƒˆ: ${integration.phase3Integration.success ? 'æˆåŠŸ' : 'å¤±æ•—'}\n`;
            if (integration.phase3Integration.success) {
                details += `  - çµ±åˆæ©Ÿèƒ½: ${integration.phase3Integration.integrationTest ? 'OK' : 'NG'}\n`;
                details += `  - æœ€é©åŒ–æ©Ÿèƒ½: ${integration.phase3Integration.optimizationTest ? 'OK' : 'NG'}\n`;
            }
            
            details += `\nEnd-to-End ãƒ†ã‚¹ãƒˆ: ${integration.endToEndTest.success ? 'æˆåŠŸ' : 'å¤±æ•—'}\n`;
            if (integration.endToEndTest.success) {
                details += `  - Phase1å®Ÿè¡Œæ™‚é–“: ${integration.endToEndTest.phase1Duration.toFixed(4)}ms\n`;
                details += `  - Phase2å®Ÿè¡Œæ™‚é–“: ${integration.endToEndTest.phase2Duration.toFixed(4)}ms\n`;
                details += `  - Phase3å®Ÿè¡Œæ™‚é–“: ${integration.endToEndTest.phase3Duration.toFixed(4)}ms\n`;
                details += `  - ç·å®Ÿè¡Œæ™‚é–“: ${integration.endToEndTest.totalDuration.toFixed(4)}ms\n`;
            }
            
            details += `\nãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ: ${integration.performanceTest.success ? 'æˆåŠŸ' : 'å¤±æ•—'}\n`;
            if (integration.performanceTest.success) {
                details += `  - ç›®æ¨™æ™‚é–“: ${integration.performanceTest.targetTime}ms\n`;
                details += `  - å®Ÿéš›æ™‚é–“: ${integration.performanceTest.actualTime.toFixed(4)}ms\n`;
                details += `  - ç›®æ¨™é”æˆ: ${integration.performanceTest.targetMet ? 'ã¯ã„' : 'ã„ã„ãˆ'}\n`;
                details += `  - è©•ä¾¡: ${integration.performanceTest.rating}\n`;
            }
            
            integrationDetails.textContent = details;
        }

        // å®Œæˆåº¦è©•ä¾¡è¡¨ç¤º
        function displayCompletionAssessment(result) {
            let assessment = "=== Phase3å®Œæˆåº¦è©•ä¾¡ ===\n";
            assessment += `çµ±åˆè©•ä¾¡: ${result.summary.overallRating}\n`;
            assessment += `å®Ÿè¡Œæ™‚é–“: ${result.executionTime.toFixed(4)}ms\n\n`;
            
            assessment += "âœ… é”æˆé …ç›®:\n";
            if (result.summary.allPhasesIntegrated) assessment += "  - å…¨Phaseçµ±åˆå®Œäº†\n";
            if (result.summary.endToEndWorking) assessment += "  - End-to-Endå‹•ä½œç¢ºèª\n";
            if (result.summary.performanceTargetMet) assessment += "  - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™é”æˆ\n";
            
            assessment += "\nğŸ¯ Phase3å®Œæˆåº¦: ";
            switch (result.summary.overallRating) {
                case 'excellent':
                    assessment += "å„ªç§€ - Phase3ã¯å®Œå…¨ã«å®Œæˆã—ã¦ã„ã¾ã™ï¼\n";
                    assessment += "ğŸ‘‰ Phase3-6ã¨Phase4æº–å‚™ã«é€²ã‚€æº–å‚™ãŒæ•´ã„ã¾ã—ãŸã€‚\n";
                    break;
                case 'good':
                    assessment += "è‰¯å¥½ - Phase3ã¯ã»ã¼å®Œæˆã—ã¦ã„ã¾ã™ã€‚\n";
                    assessment += "âš ï¸ è»½å¾®ãªæœ€é©åŒ–ãŒå¿…è¦ã§ã™ãŒã€æ¬¡æ®µéšã«é€²ã‚ã¾ã™ã€‚\n";
                    break;
                case 'acceptable':
                    assessment += "è¨±å®¹ç¯„å›² - Phase3ã¯æ©Ÿèƒ½ã—ã¦ã„ã¾ã™ãŒæ”¹å–„ã®ä½™åœ°ãŒã‚ã‚Šã¾ã™ã€‚\n";
                    assessment += "ğŸ”§ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹èª¿æ•´å¾Œã«æ¬¡æ®µéšã«é€²ã‚€ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚\n";
                    break;
                default:
                    assessment += "è¦æ”¹å–„ - Phase3ã«é‡è¦ãªå•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚\n";
                    assessment += "âŒ å•é¡Œè§£æ±ºå¾Œã«å†ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„ã€‚\n";
            }
            
            completionAssessment.textContent = assessment;
            completionAssessment.className = getRatingClass(result.summary.overallRating);
        }

        // ãã®ä»–ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
        function getRatingClass(rating) {
            switch (rating) {
                case 'excellent': return 'excellent';
                case 'good': return 'good';
                case 'acceptable': return 'acceptable';
                default: return 'needs_improvement';
            }
        }

        function updatePerformanceMetrics(metrics) {
            performanceMetrics.innerHTML = '';
            for (const [key, data] of Object.entries(metrics)) {
                const card = document.createElement('div');
                card.className = 'metric-card';
                card.innerHTML = `
                    <div class="metric-value">${data.value}</div>
                    <div class="metric-label">${data.label}</div>
                `;
                performanceMetrics.appendChild(card);
            }
        }

        function showDetailedBenchmark() {
            if (benchmarkTable.style.display === 'none') {
                benchmarkTable.style.display = 'table';
            } else {
                benchmarkTable.style.display = 'none';
            }
        }
    </script>
</body>
</html>